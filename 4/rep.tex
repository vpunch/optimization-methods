\input{../preamble}

\begin{document}
    
\newcommand{\labn}{4}
\input{../title}

\subsection*{Цель}

Изучить численные методы приближенного нахождения корня.

\subsection*{Задачи}

\begin{enumerate}
    \item Рассмотреть метод половинного деления.
    \item Рассмотреть метод хорд.
    \item Рассмотреть метод Ньютона.
\end{enumerate}

\subsection*{Ход работы}

Вывод рекурентной формулы метода хорд:
\begin{flalign*}
    &\begin{cases}
        f(x_1) = k x_1 + b\\
        f(x_2) = k x_2 + b
    \end{cases}\\
    \intertext{Вычтем из первого уравнения второе и выразим $k$}
    &f(x_1) - f(x_2) = k (x_1 - x_2)&\\
    &k = \frac{f(x_1) - f(x_2)}{x_1 - x_2}&\\
    \intertext{Подставим $k$ в первое уравнение системы и выразим $b$}
    &b = f(x_1) - \frac{x_1}{x_1 - x_2}(f(x_1) - f(x_2))&\\
    \intertext{Запишем уравнение прямой (хорды), используя полученные коэффициенты}
    &f(x) = \frac{f(x_1) - f(x_2)}{x_1 - x_2} x + f(x_1) - \frac{x_1}{x_1 - x_2}(f(x_1) - f(x_2)) = \frac{f(x_1) - f(x_2)}{x_1 - x_2} (x - x_1) + f(x_1)&\\
    \intertext{Выразим значение корня $x_3$, т. е. $x = x_3$, $y = 0$}
    &\frac{f(x_1) - f(x_2)}{x_1 - x_2} (x_3 - x_1) + f(x_1) = 0&\\
    &x_3 = -f(x_1) \frac{x_1 - x_2}{f(x_1) - f(x_2)} + x_1&
\end{flalign*}
Данная форма не требует нахождения производной.

Вывод рекурентной формулы метода Ньютона:
\begin{flalign*}
    \intertext{По определению производной}
    &\lim_{x \to x_0}\frac{f(x) - f(x_0)}{x - x_0} = f'(x)&\\
    &f(x) = f'(x)(x - x_0) + f(x_0)&
    \intertext{Найдем точку пересечения с абсциссой или первое приближение корня --- $x_1$}
    &f'(x_1)(x_1 - x_0) + f(x_0) = 0&\\
    &x_1 = x_0 - \frac{f(x_0)}{f'(x_1)}&
\end{flalign*}

Реализация требуемых методов на языке \textit{Octave} представлена в листинге ниже.
В коде можно встретить неравенство $f''(x_0) f(x_0) > 0$. 
Оно описывает обязательное требование к начальному приближению $x_0$, которым является один из концов отрезка поиска.
\insertcode{code.m}{octave}
\insertcode{../code/bisection.m}{octave}
\insertcode{../code/secant.m}{octave}
\insertcode{../code/newton.m}{octave}
\insertcode{../code/deriv2.m}{octave}
\insertcode{../code/grad.m}{octave}

Результаты нахождения корня представлены на рисунках \ref{fig:bisec}, \ref{fig:chord}, \ref{fig:newt}.
На каждом рисунке функция в различных положениях на плоскости. Благодаря правильному определению начального приближения
алгоритм сходится во всех случаях.
\imgh{bisec}{Метод половинного деления}
\imgh{chord}{Метод хорд}
\imgh{newt}{Метод Ньютона}

Зависимости количества вычислений функции от точности для каждого метода представлены на Рис.~\ref{fig:n}.
\imgh{n}{Скорость работы}

\subsection*{Вывод}

Выполнил все поставленные задачи, вывел основные формулы и написал программную реализацию требуемых методов,
сравнил их работу. Несмотря на то, что метод Ньютона показал наибольшее количетво вычислений (которое обусловлено нахождением производной),
он справился с задачей за наименьшее количество шагов.

\end{document}
